#lang eopl

(define (filter-in P L)
  (define (filter-helper P L result)
    (cond
      [(null? L) (reverse result)] ; Si la lista está vacía, devuelve el resultado invertido
      [(P (car L)) (filter-helper P (cdr L) (cons (car L) result))] ; Si el primer elemento cumple con el predicado, consérvalo y sigue filtrando el resto de la lista
      [else (filter-helper P (cdr L) result)])) ; Si el primer elemento no cumple con el predicado, omítelo y sigue filtrando el resto de la lista

  (filter-helper P L '())) ; Inicializa el resultado como una lista vacía y llama a la función auxiliar

(display (filter-in number? '(a 2 (1 3) b 7)))
(display (filter-in symbol? '(a (b c) 17 foo)))
(display (filter-in string? '(a b u "univalle" "racket" "flp" 28 90 (1 2 3))))
